{"version":3,"file":"accessibilitysupportform.min.js","sources":["../src/accessibilitysupportform.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Theme Boost Union - JS code accessibility support form\n *\n * @module     theme_boost_union/accessibilitysupportform\n * @copyright  2024 Simon Schoenenberger <scgo@zhaw.ch>\n * @copyright  on behalf of Zurich University of Applied Sciences (ZHAW)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Fill form fields with system information.\n *\n * @param {HTMLElement} form\n */\nfunction fillFormFields(form) {\n    const systemInfoField = form.querySelector('[name=techinfo]');\n\n    if (!systemInfoField) {\n        return;\n    }\n\n    const systemInfo = [\n        `windowSize=\"${window.innerWidth}Ã—${window.innerHeight}\"`,\n        `prefersReducedMotion=${window.matchMedia('(prefers-reduced-motion: reduce)').matches}`,\n        `prefersMoreContrast=${window.matchMedia('(prefers-contrast: more)').matches}`,\n        `invertedColors=${window.matchMedia('(inverted-colors: inverted)').matches}`,\n        `vendor=\"${navigator.vendor}\"`,\n        `userAgent=\"${navigator.userAgent}\"`,\n    ];\n    const replaceFields = {\n        'systeminfo': systemInfo.join('\\n'),\n    };\n\n    var infoMessage = systemInfoField.value;\n\n    for (let field in replaceFields) {\n        let value = replaceFields[field];\n        infoMessage = infoMessage.replace(`{${field}}`, value);\n    }\n\n    systemInfoField.value = infoMessage;\n    // Only set readable. Browser does not send field value if field is disabled.\n    systemInfoField.readOnly = true;\n}\n\nexport const init = (config) => {\n    const form = document.getElementById(config.formId);\n    fillFormFields(form);\n};\n"],"names":["config","form","systemInfoField","querySelector","replaceFields","window","innerWidth","innerHeight","matchMedia","matches","navigator","vendor","userAgent","join","infoMessage","value","field","replace","readOnly","fillFormFields","document","getElementById","formId"],"mappings":"+KA4DqBA;;;;;;;;;SA/BGC,YACdC,gBAAkBD,KAAKE,cAAc,uBAEtCD,6BAYCE,cAAgB,YARH,uBACAC,OAAOC,uBAAcD,OAAOE,gDACnBF,OAAOG,WAAW,oCAAoCC,uCACvDJ,OAAOG,WAAW,4BAA4BC,kCACnDJ,OAAOG,WAAW,+BAA+BC,2BACxDC,UAAUC,iCACPD,UAAUE,gBAGCC,KAAK,WAG9BC,YAAcZ,gBAAgBa,UAE7B,IAAIC,SAASZ,cAAe,KACzBW,MAAQX,cAAcY,OAC1BF,YAAcA,YAAYG,mBAAYD,WAAUD,OAGpDb,gBAAgBa,MAAQD,YAExBZ,gBAAgBgB,UAAW,EAK3BC,CADaC,SAASC,eAAerB,OAAOsB"}